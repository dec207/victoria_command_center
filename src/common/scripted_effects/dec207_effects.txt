﻿# VCC Universal Effects - Fixed Scoping & Fallback
# Prefix: dec207_

dec207_add_pop_100k_effect = {
	# Victoria 3 Scripted Effect: Final Scoping Fix
	# Current scope is State (Capital). We use 'owner' to check the country.
	# We must use 'cu:' prefix in triggers, but NO prefix in create_pop effect.
	
	# 1. Korea
	if = {
		limit = { owner = { country_has_primary_culture = cu:korean } }
		create_pop = { culture = korean religion = mahayana pop_type = laborers size = 100000 }
	}
	# 2. Belgium
	else_if = {
		limit = { 
			owner = { 
				OR = {
					country_has_primary_culture = cu:flemish 
					country_has_primary_culture = cu:wallonian
				}
			} 
		}
		create_pop = { culture = flemish religion = catholic pop_type = laborers size = 100000 }
	}
	# 3. France
	else_if = {
		limit = { owner = { country_has_primary_culture = cu:french } }
		create_pop = { culture = french religion = catholic pop_type = laborers size = 100000 }
	}
	# 4. Great Britain
	else_if = {
		limit = { owner = { country_has_primary_culture = cu:english } }
		create_pop = { culture = english religion = protestant pop_type = laborers size = 100000 }
	}
	# 5. Qing (China)
	else_if = {
		limit = { owner = { country_has_primary_culture = cu:han } }
		create_pop = { culture = han religion = mahayana pop_type = laborers size = 100000 }
	}
	# 6. Japan
	else_if = {
		limit = { owner = { country_has_primary_culture = cu:japanese } }
		create_pop = { culture = japanese religion = shinto pop_type = laborers size = 100000 }
	}
	# 7. Prussia/Germany
	else_if = {
		limit = { 
			owner = { 
				OR = {
					country_has_primary_culture = cu:north_german 
					country_has_primary_culture = cu:south_german
				}
			} 
		}
		create_pop = { culture = north_german religion = protestant pop_type = laborers size = 100000 }
	}
	# 8. Russia
	else_if = {
		limit = { owner = { country_has_primary_culture = cu:russian } }
		create_pop = { culture = russian religion = orthodox pop_type = laborers size = 100000 }
	}
	# 9. USA
	else_if = {
		limit = { 
			owner = { 
				OR = {
					country_has_primary_culture = cu:yankee 
					country_has_primary_culture = cu:dixie
				}
			} 
		}
		create_pop = { culture = yankee religion = protestant pop_type = laborers size = 100000 }
	}
	# Final Fallback: Duplicate existing population instead of hardcoding Korean
	else = {
		# If nation not listed, we use a safer effect that doubles down on what's already there
		# copy_pop_to_state would be ideal but create_pop with no culture usually defaults to common pop.
		# For now, let's just do nothing to avoid the "Korean in Paris" bug.
	}
}
